yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend("right", legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent
")))
legend(x = 1215, y=1300, legend = c(unlist(strsplit(refname,"_info\.tsv"))[1],unlist(strsplit(queryname,"_info\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
legend(x = 1215, y=1300, legend = c(unlist(strsplit(refname,"_info.tsv"))[1],unlist(strsplit(queryname,"_info.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
dev.off()
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x=1200, y=1300, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent
")))
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x=1200, y=1300, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent
")))
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info.tsv"))[1],unlist(strsplit(queryname,"_info.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x=1200, y=1300, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent
")))
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info.tsv"))[1],unlist(strsplit(queryname,"_info.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
dev.off()
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info.tsv"))[1],unlist(strsplit(queryname,"_info.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent
")))
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info.tsv"))[1],unlist(strsplit(queryname,"_info.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),
title=expression(bold("Sequences")))
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info.tsv"))[1],unlist(strsplit(queryname,"_info.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),
title=expression(bold("Sequences")))
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent
")))
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info.tsv"))[1],unlist(strsplit(queryname,"_info.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),
title=expression(bold("Sequences")))
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,
title=expression(bold("Identity percent
")))
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info\.tsv"))[1],unlist(strsplit(queryname,"_info\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info\\.tsv"))[1],unlist(strsplit(queryname,"_info\\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info\\.tsv"))[1],unlist(strsplit(queryname,"_info\\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent
")))
dev.off()
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info\\.tsv"))[1],unlist(strsplit(queryname,"_info\\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent\n")))
as.character((100-lowId)/2 + lowId)
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","",as.character((100-lowId)/2 + lowId),"","","", "","","","", "",as.character(lowId)),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent\n")))
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info\\.tsv"))[1],unlist(strsplit(queryname,"_info\\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","",as.character((100-lowId)/2 + lowId),"","","", "","","","", "",as.character(lowId)),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent\n")))
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info\\.tsv"))[1],unlist(strsplit(queryname,"_info\\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","","(100-lowId)/2 + lowId","","","", "","","","", "","lowId"),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent\n")))
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent\n")))
c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId)
colors
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info\\.tsv"))[1],unlist(strsplit(queryname,"_info\\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent\n")))
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info\\.tsv"))[1],unlist(strsplit(queryname,"_info\\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent\n")))
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
queryname<-"genome2.fna_info.tsv"
handlefile<-"parsed.tsv"
refname<-"genome1.fna_info.tsv"
queryname<-"genome2.fna_info.tsv"
handle<-read.table(handlefile,sep = "\t",stringsAsFactors = F,check.names = F)
ref<-read.table(refname,sep = "\t",stringsAsFactors = F,check.names = F)
query<-read.table(queryname,sep = "\t", stringsAsFactors = F,check.names = F)
rownames(ref)<-ref$V1
rownames(query)<-query$V1
qryUniq<-unique(sort(handle$V1))
refUniq<-unique(sort(handle$V2))
gl<-sum(query[qryUniq,3])
gl<-gl+sum(ref[refUniq,3])
ref<-ref[refUniq,]
query<-query[qryUniq,]
data<-rbind(ref,query)
lowId<-min(handle$V3)
link.pg.v<-data.frame(seg1=handle$V1, start1=handle$V4, end1=handle$V5, seg2=handle$V2, start2=handle$V6, end2=handle$V7)
measure<-data.frame(seg.name=seq(1:8), seg.start=seq(1:8), seg.end=seq(1:8)+1, seg.value=1)
measure2<-data.frame(seg.name=1, seg.start=1, seg.end=signif(2*gl/12/1000), seg.value=round(2*gl/12/1000,0))
measure4<-data.frame(seg.name=1, seg.start=1, seg.end=signif(4*gl/12/1000), seg.value=round(4*gl/12/1000,0))
measure8<-data.frame(seg.name=1, seg.start=1, seg.end=signif(8*gl/12/1000), seg.value=round(8*gl/12/1000,0))
measure10<-data.frame(seg.name=1, seg.start=1, seg.end=signif(10*gl/12/1000), seg.value=round(10*gl/12/1000,0))
measure["V5"]<-measure2["V5"]<-measure4["V5"]<-measure8["V5"]<-measure10["V5"]<-1
data["V5"]<-data["V4"]<-1
colnames(data)<- c("chr", "start", "end","V4","V5")
tocirmeasure<-segAnglePo(measure, seg=c(as.matrix(measure["seg.name"][,])))
tocirmeasure[2,2]<-300;tocirmeasure[2,3]<-620
tocirmeasure[3,2]<-0;tocirmeasure[3,3]<-620
tocirmeasure[4,2]<-420;tocirmeasure[4,3]<-620
tocirmeasure[5,2]<-90;tocirmeasure[5,3]<-620
tocirmeasure[6,2]<-120;tocirmeasure[6,3]<-620
tocirmeasure[7,2]<-180;tocirmeasure[7,3]<-620
tocirmeasure[8,2]<-240;tocirmeasure[8,3]<-620
tocirmeasure2<-segAnglePo(measure2, seg=c(as.matrix(measure2["seg.name"][,])))
tocirmeasure2[1,2]<-330
tocirmeasure4<-segAnglePo(measure4, seg=c(as.matrix(measure4["seg.name"][,])))
tocirmeasure4[1,2]<-395
tocirmeasure8<-segAnglePo(measure8, seg=c(as.matrix(measure8["seg.name"][,])))
tocirmeasure8[1,2]<-146
tocirmeasure10<-segAnglePo(measure10, seg=c(as.matrix(measure10["seg.name"][,])))
tocirmeasure10[1,2]<-210
tocir <- segAnglePo(data, seg=c(as.matrix(data["chr"][,])))
colors<-rev(colorRampPalette(rev(brewer.pal(n = 7, name = "RdYlBu")))(20))
delta<-(100-lowId)/20
scaleColors<- function(x){
cArray<-c()
for(id in x){
for(i in 1:20){
if(id>=100-(delta*i)){
break
}
}
cArray<-c(cArray,colors[i])
}
return(cArray)
}
link.pg.v[,"colors"]<-scaleColors(handle$V3)
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 1200, y=1300, legend = c(unlist(strsplit(refname,"_info\\.tsv"))[1],unlist(strsplit(queryname,"_info\\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
legend(x=1200, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent\n")))
dev.off()
pdf(file="synteny.pdf", width = 10, height =10)
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 3200, y=1300, legend = c(unlist(strsplit(refname,"_info\\.tsv"))[1],unlist(strsplit(queryname,"_info\\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
legend(x=1300, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent\n")))
dev.off()
legend(x=1300, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent\n")))
lowId
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
tocir
xorigin
yorigin
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
library(OmicCircos)
library(RColorBrewer)
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
circos(R=440, cir=tocir, W=10, mapping=link.pg.v , type="link.pg", lwd=1, col=link.pg.v$colors,xc = xorigin,yc = yorigin)
legend(x = 3200, y=1300, legend = c(unlist(strsplit(refname,"_info\\.tsv"))[1],unlist(strsplit(queryname,"_info\\.tsv"))[1]),
ncol = 1, cex = 0.8,  bty="n",
fill=c("dark blue","#FEE496"),
border = c("dark blue","#FEE496"),text.width=c(0.5,0.5),
title=expression(bold("Sequences")))
legend(x=1300, y=1100, legend = c("100","","","", "","","","", "","",(100-lowId)/2 + lowId,"","","", "","","","", "",lowId),
ncol = 1, cex = 0.8,  bty="n",
fill=colors,
border = colors,
y.intersp = 0.5,
x.intersp = 0.5,text.width=c(0.5,0.5),
title=expression(bold("Identity percent\n")))
dev.off()
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
handlefile<-"parsed.tsv"
refname<-"genome1.fna_info.tsv"
queryname<-"genome2.fna_info.tsv"
handle<-read.table(handlefile,sep = "\t",stringsAsFactors = F,check.names = F)
ref<-read.table(refname,sep = "\t",stringsAsFactors = F,check.names = F)
query<-read.table(queryname,sep = "\t", stringsAsFactors = F,check.names = F)
rownames(ref)<-ref$V1
rownames(query)<-query$V1
qryUniq<-unique(sort(handle$V1))
refUniq<-unique(sort(handle$V2))
gl<-sum(query[qryUniq,3])
gl<-gl+sum(ref[refUniq,3])
ref<-ref[refUniq,]
query<-query[qryUniq,]
data<-rbind(ref,query)
lowId<-min(handle$V3)
link.pg.v<-data.frame(seg1=handle$V1, start1=handle$V4, end1=handle$V5, seg2=handle$V2, start2=handle$V6, end2=handle$V7)
measure<-data.frame(seg.name=seq(1:8), seg.start=seq(1:8), seg.end=seq(1:8)+1, seg.value=1)
measure2<-data.frame(seg.name=1, seg.start=1, seg.end=signif(2*gl/12/1000), seg.value=round(2*gl/12/1000,0))
measure4<-data.frame(seg.name=1, seg.start=1, seg.end=signif(4*gl/12/1000), seg.value=round(4*gl/12/1000,0))
measure8<-data.frame(seg.name=1, seg.start=1, seg.end=signif(8*gl/12/1000), seg.value=round(8*gl/12/1000,0))
measure10<-data.frame(seg.name=1, seg.start=1, seg.end=signif(10*gl/12/1000), seg.value=round(10*gl/12/1000,0))
measure["V5"]<-measure2["V5"]<-measure4["V5"]<-measure8["V5"]<-measure10["V5"]<-1
data["V5"]<-data["V4"]<-1
colnames(data)<- c("chr", "start", "end","V4","V5")
tocirmeasure<-segAnglePo(measure, seg=c(as.matrix(measure["seg.name"][,])))
tocirmeasure[2,2]<-300;tocirmeasure[2,3]<-620
tocirmeasure[3,2]<-0;tocirmeasure[3,3]<-620
tocirmeasure[4,2]<-420;tocirmeasure[4,3]<-620
tocirmeasure[5,2]<-90;tocirmeasure[5,3]<-620
tocirmeasure[6,2]<-120;tocirmeasure[6,3]<-620
tocirmeasure[7,2]<-180;tocirmeasure[7,3]<-620
tocirmeasure[8,2]<-240;tocirmeasure[8,3]<-620
tocirmeasure2<-segAnglePo(measure2, seg=c(as.matrix(measure2["seg.name"][,])))
tocirmeasure2[1,2]<-330
tocirmeasure4<-segAnglePo(measure4, seg=c(as.matrix(measure4["seg.name"][,])))
tocirmeasure4[1,2]<-395
tocirmeasure8<-segAnglePo(measure8, seg=c(as.matrix(measure8["seg.name"][,])))
tocirmeasure8[1,2]<-146
tocirmeasure10<-segAnglePo(measure10, seg=c(as.matrix(measure10["seg.name"][,])))
tocirmeasure10[1,2]<-210
tocir <- segAnglePo(data, seg=c(as.matrix(data["chr"][,])))
colors<-rev(colorRampPalette(rev(brewer.pal(n = 7, name = "RdYlBu")))(20))
delta<-(100-lowId)/20
scaleColors<- function(x){
cArray<-c()
for(id in x){
for(i in 1:20){
if(id>=100-(delta*i)){
break
}
}
cArray<-c(cArray,colors[i])
}
return(cArray)
}
link.pg.v[,"colors"]<-scaleColors(handle$V3)
link.pg.v
xorigin=600
yorigin=750
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
library(OmicCircos)
library(RColorBrewer)
plot(c(0,1500), c(0,1500), type="n", axes=FALSE, xlab="", ylab="", main="")
circos(R=450, cir=tocir, W=10,type="chr", print.chr.lab=T, scale=F,xc = xorigin,yc = yorigin,
col = c(rep("dark blue",nrow(ref)),rep("#FEE496",nrow(query))),cex = 10)
